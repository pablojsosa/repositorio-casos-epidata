<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Repositorio de Casos de √âxito</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Repositorio de Casos de √âxito</h1>
  </header>

  <section class="filters">
    <input type="text" id="searchInput" placeholder="Buscar por nombre, partner..." />
    <select id="partnerFilter">
      <option value="">Todos los Partners</option>
    </select>
    <select id="areaFilter">
      <option value="">Todas las √Åreas</option>
    </select>
    <select id="sectorFilter">
      <option value="">Todos los Sectores</option>
    </select>
    <div class="view-buttons">
      <button id="gridViewBtn">üü¶ Cuadr√≠cula</button>
      <button id="listViewBtn">üìÑ Lista</button>
    </div>
  </section>

  <section id="casosContainer" class="grid-view"></section>

  <script>
    let data = [];
    const container = document.getElementById("casosContainer");

    async function fetchData() {
      const res = await fetch("data.json");
      data = await res.json();
      populateFilters();
      renderCasos(data);
    }

    function populateFilters() {
      const partnerSet = new Set();
      const areaSet = new Set();
      const sectorSet = new Set();

      data.forEach(caso => {
        partnerSet.add(caso.partner);
        areaSet.add(caso.area);
        sectorSet.add(caso.sector);
      });

      fillSelect("partnerFilter", partnerSet);
      fillSelect("areaFilter", areaSet);
      fillSelect("sectorFilter", sectorSet);
    }

    function fillSelect(id, set) {
      const select = document.getElementById(id);
      set.forEach(value => {
        const option = document.createElement("option");
        option.value = value;
        option.textContent = value;
        select.appendChild(option);
      });
    }

    function renderCasos(casos) {
      container.innerHTML = "";
      casos.forEach(caso => {
        const div = document.createElement("div");
        div.className = "caso-card";
        div.innerHTML = `
          <h3>${caso.nombre}</h3>
          <p><strong>Partner:</strong> ${caso.partner}</p>
          <p><strong>√Årea:</strong> ${caso.area}</p>
          <p><strong>Sector:</strong> ${caso.sector}</p>
          <a href="${caso.url}" target="_blank">Ver caso</a>
        `;
        container.appendChild(div);
      });
    }

    function applyFilters() {
      const search = document.getElementById("searchInput").value.toLowerCase();
      const partner = document.getElementById("partnerFilter").value;
      const area = document.getElementById("areaFilter").value;
      const sector = document.getElementById("sectorFilter").value;

      const filtered = data.filter(caso =>
        (!search || caso.nombre.toLowerCase().includes(search) || caso.partner.toLowerCase().includes(search)) &&
        (!partner || caso.partner === partner) &&
        (!area || caso.area === area) &&
        (!sector || caso.sector === sector)
      );

      renderCasos(filtered);
    }

    document.getElementById("searchInput").addEventListener("input", applyFilters);
    document.getElementById("partnerFilter").addEventListener("change", applyFilters);
    document.getElementById("areaFilter").addEventListener("change", applyFilters);
    document.getElementById("sectorFilter").addEventListener("change", applyFilters);
    document.getElementById("gridViewBtn").addEventListener("click", () => {
      container.classList.add("grid-view");
      container.classList.remove("list-view");
    });
    document.getElementById("listViewBtn").addEventListener("click", () => {
      container.classList.add("list-view");
      container.classList.remove("grid-view");
    });

    fetchData();
  </script>
</body>
</html>
