<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Repositorio de Casos de Éxito</title>
  <link rel="stylesheet" href="estilos.css" />
</head>
<body>
  <h1>Repositorio de Casos de Éxito</h1>

  <div class="filtros">
    <input type="text" id="busqueda" placeholder="Buscar por nombre, partner" />
    <select id="filtroPartner">
      <option value="">Todos los Partners</option>
    </select>
    <select id="filtroArea">
      <option value="">Todas las Áreas</option>
    </select>
    <select id="filtroSector">
      <option value="">Todos los Sectores</option>
    </select>
  </div>

  <div class="vista-toggle">
    <button onclick="cambiarVista('cuadricula')">Cuadrícula</button>
    <button onclick="cambiarVista('lista')">Lista</button>
  </div>

  <div id="contenedorCasos" class="cuadricula"></div>

  <script>
    let vistaActual = 'cuadricula';

    function cambiarVista(vista) {
      vistaActual = vista;
      document.getElementById('contenedorCasos').className = vista;
      mostrarCasos();
    }

    let casos = [];

    fetch('casos.json')
      .then(response => response.json())
      .then(data => {
        casos = data;
        cargarFiltros();
        mostrarCasos();
      });

    function cargarFiltros() {
      const partners = new Set();
      const areas = new Set();
      const sectores = new Set();

      casos.forEach(caso => {
        partners.add(caso.partner);
        areas.add(caso.area);
        sectores.add(caso.sector);
      });

      partners.forEach(p => agregarOpcion('filtroPartner', p));
      areas.forEach(a => agregarOpcion('filtroArea', a));
      sectores.forEach(s => agregarOpcion('filtroSector', s));
    }

    function agregarOpcion(idSelect, valor) {
      const select = document.getElementById(idSelect);
      const option = document.createElement('option');
      option.value = valor;
      option.textContent = valor;
      select.appendChild(option);
    }

    function mostrarCasos() {
      const contenedor = document.getElementById('contenedorCasos');
      contenedor.innerHTML = '';

      const textoBusqueda = document.getElementById('busqueda').value.toLowerCase();
      const filtroPartner = document.getElementById('filtroPartner').value;
      const filtroArea = document.getElementById('filtroArea').value;
      const filtroSector = document.getElementById('filtroSector').value;

      const filtrados = casos.filter(caso =>
        (!textoBusqueda || caso.nombre.toLowerCase().includes(textoBusqueda) || caso.partner.toLowerCase().includes(textoBusqueda)) &&
        (!filtroPartner || caso.partner === filtroPartner) &&
        (!filtroArea || caso.area === filtroArea) &&
        (!filtroSector || caso.sector === filtroSector)
      );

      filtrados.forEach(caso => {
        const div = document.createElement('div');
        div.className = 'caso';

        const link = document.createElement('a');
        link.href = caso.link;
        link.target = '_blank';
        link.textContent = caso.nombre;

        div.appendChild(link);
        div.innerHTML += `
          <p><strong>Partner:</strong> ${caso.partner}</p>
          <p><strong>Área:</strong> ${caso.area}</p>
          <p><strong>Sector:</strong> ${caso.sector}</p>
        `;
        contenedor.appendChild(div);
      });
    }

    document.getElementById('busqueda').addEventListener('input', mostrarCasos);
    document.getElementById('filtroPartner').addEventListener('change', mostrarCasos);
    document.getElementById('filtroArea').addEventListener('change', mostrarCasos);
    document.getElementById('filtroSector').addEventListener('change', mostrarCasos);
  </script>
</body>
</html>
